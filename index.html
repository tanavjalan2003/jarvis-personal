<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>JARVIS â€” Personal Assistant</title>
  <style>
    :root{
      --bg:#07080a; /* very dark */
      --panel:#071226; /* deep navy */
      --accent:#0096ff; /* bright blue */
      --accent-2:#00c3ff; /* lighter cyan */
      --muted:#97a6bf;
      --glass: rgba(255,255,255,0.03);
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background: radial-gradient(1200px 600px at 10% 20%, rgba(0,150,255,0.06), transparent),
                  linear-gradient(180deg,var(--bg), #031026 60%);
      color:#dbe8ff;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      display:flex;align-items:center;justify-content:center;
      padding:24px;
    }

    /* Container */
    .shell{
      width:980px; max-width:98vw; min-height:560px; border-radius:18px; overflow:hidden;
      background: linear-gradient(180deg, rgba(9,20,36,0.6), rgba(3,6,12,0.6));
      box-shadow: 0 20px 50px rgba(2,6,14,0.7);
      display:grid; grid-template-columns: 360px 1fr; gap:20px; padding:18px;
      border:1px solid rgba(0,150,255,0.08);
    }

    /* Left column: avatar + controls */
    .left{
      background: linear-gradient(180deg, rgba(1,10,20,0.4), rgba(3,8,16,0.35));
      border-radius:12px; padding:18px; display:flex; flex-direction:column; gap:12px;
      border:1px solid rgba(0,150,255,0.05);
    }

    .avatar{
      height:160px; border-radius:12px; background:linear-gradient(120deg,var(--accent), var(--accent-2));
      display:flex; align-items:center; justify-content:center; position:relative; overflow:hidden; box-shadow: 0 6px 30px rgba(0,150,255,0.06) inset;
      font-weight:700; font-size:22px; color:#001225;
    }

    .avatar .glow{ position:absolute; inset:0; opacity:0.12; mix-blend-mode:screen }

    .status{display:flex; gap:10px; align-items:center; font-size:13px; color:var(--muted)}
    .dot{width:10px;height:10px;border-radius:50%;background:linear-gradient(180deg,#00ffea,#0077ff); box-shadow:0 0 12px rgba(0,150,255,0.45)}

    .controls{display:flex; gap:8px; flex-wrap:wrap}
    button.ctrl{flex:1;padding:10px 12px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);background:var(--glass);color:var(--accent-2);font-weight:600;cursor:pointer}
    button.ctrl.secondary{background:transparent;color:var(--muted);border:1px dashed rgba(255,255,255,0.02)}

    .quick-list{margin-top:6px;font-size:13px;color:var(--muted)}
    .quick-list b{color:var(--accent-2)}

    /* Right column: transcript and input */
    .main{display:flex;flex-direction:column; gap:12px}
    .header{display:flex;align-items:center;justify-content:space-between}
    .title{font-size:18px;font-weight:600;letter-spacing:0.4px}
    .sub{font-size:12px;color:var(--muted)}

    .transcript{
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:12px;padding:14px;flex:1;overflow:auto;border:1px solid rgba(0,150,255,0.04)
    }

    .msg{padding:8px 12px;border-radius:10px;margin-bottom:8px;max-width:78%;line-height:1.25}
    .msg.user{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));color:#dbe8ff;margin-left:auto;border:1px solid rgba(255,255,255,0.03)}
    .msg.jarvis{background:linear-gradient(180deg, rgba(0,150,255,0.06), rgba(0,120,200,0.03));color:#e9fbff;border:1px solid rgba(0,150,255,0.12)}

    .input-row{display:flex;gap:8px;align-items:center}
    input[type=text]{flex:1;padding:12px 14px;border-radius:12px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit;font-size:15px}
    .mic{width:56px;height:44px;border-radius:10px;border:1px solid rgba(0,150,255,0.06);display:flex;align-items:center;justify-content:center;cursor:pointer}

    .wave{
      width:100%;height:60px;margin-top:8px;border-radius:8px;background:linear-gradient(90deg, rgba(0,150,255,0.04), transparent 30%);
      position:relative;overflow:hidden
    }
    .bars{position:absolute;bottom:0;left:0;right:0;display:flex;align-items:end;gap:4px;padding:8px}
    .bar{width:6px;height:8px;background:linear-gradient(180deg,var(--accent-2),var(--accent));border-radius:4px;opacity:0.9}

    /* footer */
    .footer{display:flex;justify-content:space-between;align-items:center;font-size:13px;color:var(--muted)}

    /* responsive */
    @media (max-width:880px){.shell{grid-template-columns:1fr; padding:12px}.left{order:2}}
  </style>
</head>
<body>
  <div class="shell" role="application" aria-label="Jarvis personal assistant UI">
    <div class="left">
      <div class="avatar" aria-hidden="true">
        <svg class="glow" viewBox="0 0 800 200" preserveAspectRatio="none" style="width:140%;height:140%;opacity:0.12;filter:blur(30px)">
          <defs>
            <linearGradient id="g" x1="0" x2="1"><stop offset="0" stop-color="#00c3ff"/><stop offset="1" stop-color="#0077ff"/></linearGradient>
          </defs>
          <rect x="-50" y="-50" width="900" height="400" fill="url(#g)"/>
        </svg>
        J A R V I S
      </div>

      <div class="status"><span class="dot" aria-hidden="true"></span><div>
        <div style="font-weight:700">Online</div>
        <div style="font-size:12px;color:var(--muted)">Listening: <span id="listeningState">off</span></div>
      </div></div>

      <div class="controls">
        <button class="ctrl" id="btnListen">Start Listening</button>
        <button class="ctrl secondary" id="btnStop">Stop</button>
        <button class="ctrl" id="btnSpeak">Speak Last</button>
      </div>

      <div class="quick-list">
        Try commands: <br>
        <b>time</b>, <b>search for &lt;term&gt;</b>, <b>open &lt;url&gt;</b>, <b>calculate 12*5+3</b>, <b>joke</b>
      </div>

      <div style="margin-top:auto;font-size:12px;color:var(--muted)">
        Built with <span style="color:var(--accent-2)">Web Speech API</span> â€¢ Offline command parsing
      </div>
    </div>

    <div class="main">
      <div class="header">
        <div>
          <div class="title">JARVIS</div>
          <div class="sub">Blue & Black Personal Assistant</div>
        </div>
        <div class="sub">Status: <span id="statusSmall">Ready</span></div>
      </div>

      <div class="transcript" id="transcript" aria-live="polite">
        <div class="msg jarvis">Hello â€” I'm JARVIS. Say <b>"help"</b> to see suggestions.</div>
      </div>

      <div>
        <div class="input-row">
          <input type="text" id="textInput" placeholder="Type a command or ask something... (e.g. 'what time is it')" aria-label="Command input" />
          <div class="mic" id="micBtn" title="Start voice input">ðŸŽ¤</div>
          <button class="ctrl" id="sendBtn">Send</button>
        </div>

        <div class="wave" aria-hidden="true">
          <div class="bars" id="bars"></div>
        </div>
      </div>

      <div class="footer">
        <div id="footerLeft">Voice: <span id="voiceName">Default</span></div>
        <div id="footerRight">v1.0 â€¢ Offline</div>
      </div>
    </div>
  </div>

<script>
// --- Utilities ---
const transcriptEl = document.getElementById('transcript');
const listeningState = document.getElementById('listeningState');
const micBtn = document.getElementById('micBtn');
const btnListen = document.getElementById('btnListen');
const btnStop = document.getElementById('btnStop');
const btnSpeak = document.getElementById('btnSpeak');
const sendBtn = document.getElementById('sendBtn');
const textInput = document.getElementById('textInput');
const statusSmall = document.getElementById('statusSmall');
const voiceName = document.getElementById('voiceName');
const bars = document.getElementById('bars');

let lastJarvisText = '';

function appendMessage(text, who='jarvis'){
  const div = document.createElement('div');
  div.className = 'msg ' + (who==='user' ? 'user' : 'jarvis');
  div.innerHTML = text.replace(/\n/g, '<br>');
  transcriptEl.appendChild(div);
  transcriptEl.scrollTop = transcriptEl.scrollHeight;
}

function speak(text, opts={}){
  if(!('speechSynthesis' in window)) return;
  const u = new SpeechSynthesisUtterance(text);
  if(opts.lang) u.lang = opts.lang;
  if(opts.voice) u.voice = opts.voice;
  u.rate = opts.rate || 1;
  u.volume = opts.volume || 1;
  lastJarvisText = text;
  window.speechSynthesis.cancel();
  window.speechSynthesis.speak(u);
}

btnSpeak.addEventListener('click', ()=>{ if(lastJarvisText) speak(lastJarvisText); });

// --- Simple command parser ---
function handleCommand(raw){
  const cmd = raw.trim();
  appendMessage(cmd, 'user');
  statusSmall.textContent = 'Processing';

  // basic keywords
  const low = cmd.toLowerCase();
  if(low==='help'){
    const helpText = "I can: tell time, search the web, open a url, calculate expressions, tell a joke, change theme.\nExamples:\nsearch for cats\nopen https://example.com\ncalculate 12*3+4\nwhat time is it";
    appendMessage(helpText);
    speak('Here are some things you can ask me.');
    statusSmall.textContent = 'Ready';
    return;
  }

  if(/^(what('|â€™)s|what is|what time).*(time|clock)|time$/i.test(low)){
    const now = new Date();
    const t = now.toLocaleTimeString();
    appendMessage('The time is ' + t);
    speak('The time is ' + t);
    statusSmall.textContent = 'Ready';
    return;
  }

  if(low.startsWith('search for ')){
    const q = encodeURIComponent(cmd.slice(11));
    const msg = `Searching the web for "${cmd.slice(11)}" and opening results...`;
    appendMessage(msg);
    speak('Searching the web for ' + cmd.slice(11));
    window.open('https://www.google.com/search?q=' + q, '_blank');
    statusSmall.textContent = 'Ready';
    return;
  }

  if(low.startsWith('open ')){
    let url = cmd.slice(5).trim();
    if(!/^https?:\/\//i.test(url)) url = 'https://' + url;
    appendMessage('Opening ' + url);
    speak('Opening that link');
    window.open(url, '_blank');
    statusSmall.textContent = 'Ready';
    return;
  }

  if(low.startsWith('calculate ') || /^(calc|compute) /.test(low)){
    const expr = cmd.replace(/^(calculate|calc|compute)\s+/i, '');
    try{
      // evaluate safely: allow numbers and operators only
      if(!/^[0-9+\-*/(). %^]+$/.test(expr.replace(/\s+/g,''))) throw new Error('unsafe');
      // replace ^ with **
      const safeExpr = expr.replace(/\^/g,'**');
      const result = Function('return ('+safeExpr+')')();
      appendMessage(expr + ' = ' + result);
      speak('The result is ' + result);
    }catch(e){
      appendMessage('Sorry, I could not calculate that.');
      speak('I could not calculate that expression.');
    }
    statusSmall.textContent = 'Ready';
    return;
  }

  if(low==='joke'){
    const jokes = [
      "Why do programmers prefer dark mode? Because light attracts bugs.",
      "I told my computer I needed a break â€” it said 'no problem, I'll go to sleep.'",
      "Why did the developer go broke? Because he used up all his cache."
    ];
    const j = jokes[Math.floor(Math.random()*jokes.length)];
    appendMessage(j);
    speak(j);
    statusSmall.textContent = 'Ready';
    return;
  }

  if(low.startsWith('set theme') || low.startsWith('theme ')){
    // simple theme toggles
    if(low.includes('blue')){
      document.documentElement.style.setProperty('--accent','#0096ff');
      document.documentElement.style.setProperty('--accent-2','#00c3ff');
      appendMessage('Theme set to blue.'); speak('Theme set to blue');
    }else if(low.includes('green')){
      document.documentElement.style.setProperty('--accent','#00b37e');
      document.documentElement.style.setProperty('--accent-2','#00ffd0');
      appendMessage('Theme set to green.'); speak('Theme set to green');
    }else{
      appendMessage('Available themes: blue, green. Try: "set theme blue"');
      speak('Try set theme blue or green');
    }
    statusSmall.textContent = 'Ready';
    return;
  }

  // fallback - short chatty responses
  if(/^(hi|hello|hey)\b/i.test(low)){
    appendMessage('Hello â€” how can I help you today?'); speak('Hello, how can I help you'); statusSmall.textContent='Ready'; return;
  }

  appendMessage("Sorry, I didn't understand that. Say 'help' to see examples.");
  speak("Sorry, I didn't understand that.");
  statusSmall.textContent = 'Ready';
}

sendBtn.addEventListener('click', ()=>{ const v=textInput.value.trim(); if(!v) return; handleCommand(v); textInput.value=''; });
textInput.addEventListener('keydown', e=>{ if(e.key==='Enter'){ sendBtn.click(); }});

// --- Voice recognition (if available) ---
let recognition = null;
let recognizing = false;
try{
  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
  if(SpeechRecognition){
    recognition = new SpeechRecognition();
    recognition.continuous = false;
    recognition.interimResults = false;
    recognition.lang = 'en-US';

    recognition.onstart = ()=>{ recognizing=true; listeningState.textContent='on'; btnListen.textContent='Listening...'; statusSmall.textContent='Listening'; }
    recognition.onend = ()=>{ recognizing=false; listeningState.textContent='off'; btnListen.textContent='Start Listening'; statusSmall.textContent='Ready'; }
    recognition.onresult = (ev)=>{
      const t = ev.results[0][0].transcript;
      handleCommand(t);
    }
    recognition.onerror = (ev)=>{ console.error('Speech error', ev); appendMessage('Voice error: '+ev.error); }
  }
}catch(e){ console.warn('SpeechRecognition not supported'); }

btnListen.addEventListener('click', ()=>{
  if(!recognition) { appendMessage('Speech recognition not supported in your browser.'); return; }
  if(!recognizing){ recognition.start(); } else { recognition.stop(); }
});
btnStop.addEventListener('click', ()=>{ if(recognition && recognizing) recognition.stop(); window.speechSynthesis.cancel(); appendMessage('Stopped.'); });
micBtn.addEventListener('click', ()=> btnListen.click());

// --- Visualizer bars (fake) ---
function makeBars(n=28){ bars.innerHTML=''; for(let i=0;i<n;i++){ const b=document.createElement('div'); b.className='bar'; b.style.height = (8 + Math.random()*48) + 'px'; bars.appendChild(b);} }
makeBars(); setInterval(()=>{ const bs = document.querySelectorAll('.bar'); bs.forEach(b=>{ b.style.height = (8 + Math.random()*48) + 'px'; }); }, 350);

// --- Speech voices setup ---
function loadVoices(){ const vlist = window.speechSynthesis.getVoices(); if(vlist.length){ voiceName.textContent = (vlist[0] && vlist[0].name) || 'Default'; }
}
if('speechSynthesis' in window){ window.speechSynthesis.onvoiceschanged = loadVoices; loadVoices(); }

// --- Extras: keyboard shortcuts ---
document.addEventListener('keydown', e=>{
  if(e.key==='/' && e.target.tagName!=='INPUT' && e.target.tagName!=='TEXTAREA'){ e.preventDefault(); textInput.focus(); }
  if(e.key==='.' && e.ctrlKey){ btnListen.click(); }
});

// welcome voice
setTimeout(()=>{ speak('Jarvis online. Ready when you are.'); }, 900);
</script>
</body>
</html>
